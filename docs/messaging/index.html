<!DOCTYPE html>
<html class="no-js">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>AXP Messaging</title>
    <link href="images/logo-icon.svg" rel="icon" type="image/svg">
    <script>var pathToRoot = "";</script>
    <script>document.documentElement.classList.replace("no-js","js");</script>
    <script>const storage = localStorage.getItem("dokka-dark-mode")
    if (storage == null) {
        const osDarkSchemePreferred = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        if (osDarkSchemePreferred === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    } else {
        const savedDarkMode = JSON.parse(storage)
        if(savedDarkMode === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    }
    </script>
<script type="text/javascript" src="https://unpkg.com/kotlin-playground@1/dist/playground.min.js" async="async"></script>
<script type="text/javascript" src="scripts/sourceset_dependencies.js" async="async"></script>
<link href="styles/style.css" rel="Stylesheet">
<link href="styles/main.css" rel="Stylesheet">
<link href="styles/prism.css" rel="Stylesheet">
<link href="styles/logo-styles.css" rel="Stylesheet">
<link href="styles/font-jb-sans-auto.css" rel="Stylesheet">
<script type="text/javascript" src="scripts/clipboard.js" async="async"></script>
<script type="text/javascript" src="scripts/navigation-loader.js" async="async"></script>
<script type="text/javascript" src="scripts/platform-content-handler.js" async="async"></script>
<script type="text/javascript" src="scripts/main.js" defer="defer"></script>
<script type="text/javascript" src="scripts/prism.js" async="async"></script>
<script type="text/javascript" src="scripts/symbol-parameters-wrapper_deferred.js" defer="defer"></script>
</head>
<body>
    <div class="root">
<nav class="navigation" id="navigation-wrapper">
    <div class="navigation--inner">
        <div class="navigation-title">
            <button class="menu-toggle" id="menu-toggle" type="button">toggle menu</button>
            <div class="library-name">
                    <a class="library-name--link" href="index.html">
                            AXP Messaging
                    </a>
            </div>
            <div class="library-version">
0.1            </div>
        </div>
        <div class="filter-section" id="filter-section">
                <button class="platform-tag platform-selector jvm-like" data-active="" data-filter=":messaging:dokkaHtml/main">jvm</button>
        </div>
    </div>
    <div class="navigation-controls">
        <button class="navigation-controls--btn navigation-controls--theme" id="theme-toggle-button" type="button">switch theme</button>
        <div class="navigation-controls--btn navigation-controls--search" id="searchBar" role="button">search in API</div>
    </div>
</nav>
        <div id="container">
            <div class="sidebar" id="leftColumn">
                <div class="sidebar--inner" id="sideMenu"></div>
            </div>
            <div id="main">
<div class="main-content" id="content" pageIds="AXP Messaging::////PointingToDeclaration//966333465">
  <div class="breadcrumbs"></div>
  <div class="cover ">
    <h1 class="cover"><span><span>AXP</span></span> <span><span>Messaging</span></span></h1>
    <div class="platform-hinted UnderCoverText" data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":messaging:dokkaHtml/main"><p class="paragraph">The AXP Messaging Sdk enables asynchronous communication, allowing end users to resume conversation threads at any time and view all previous messages exchanged as part of the conversation. This is unlike a session-based chat, where the chat is closed after the participants disconnect the dialog.</p><p class="paragraph">This document will guide you through the installation and usage of the AXP Messaging Sdk. Let's get started!</p><h3 class="">Adding the AXP Messaging SDK to Your Project</h3><p class="paragraph">The AXP Messaging sdk is distributed as a Maven artifact. To include it in your project, you need to add the following lines to your <code class="lang-kotlin">build.gradle</code> file:</p><p class="paragraph">If you're using Groovy, add:</p><div class="sample-container"><pre><code class="block lang-groovy" theme="idea">dependencies {<br>    implementation 'com.avaya.sdk:messaging:${avayaSdkVersion}'<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><p class="paragraph">If you're using Kotlin DSL, add:</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">dependencies {<br>    implementation(&quot;com.avaya.sdk:messaging:${avayaSdkVersion}&quot;)<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><p class="paragraph">In both cases, replace ${avayaSdkVersion} with the latest version of the AXP SDK. You can find the latest version on the <a href="">AXP SDK releases page</a>.</p><p class="paragraph">After adding these lines, run a build to download and integrate the AXP Messaging sdk into your project.</p><p class="paragraph">With these steps, you should be ready to start using the Messaging SDK in your project. If you encounter any issues, please refer to our <a href="">troubleshooting guide</a> or contact our <a href="">support team</a>.</p><h2 class="">Functionality</h2><p class="paragraph">The AXP Messaging sdk offers a range of features, including adding and removing idle timeout listeners, emitting idle timeouts, listening to event states, reconnecting sessions, resetting idle timeouts, and fetching notification data.</p><h2 class="">Sending a Message with the AXP Messaging sdk</h2><p class="paragraph">The AXP Messaging sdk allows you to send messages to agents in AXP. This feature is built on the AXP Core sdk, which manages user sessions.</p><h3 class="">Prerequisites</h3><p class="paragraph">Before you can send a message, you need a valid <code class="lang-kotlin">Conversation</code>. You can obtain this by calling <code class="lang-kotlin">AxpClientSdk.getDefaultConversation()</code> from the AXP Core module.</p><p class="paragraph">Here's an example of getting default conversation:</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">launch {<br>    when (val result = AxpClientSdk.getDefaultConversation()) {<br>        is AxpResult.Success -&gt; {<br>            val defaultConversation = result<br>            // Use the userSession to send a message<br>        }<br>        is AxpResult.Failure -&gt; {<br>            val error = result.error<br>            // Handle the error<br>        }<br>    }<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h2 class="">Sending a Message</h2><p class="paragraph">Once you have a valid <code class="lang-kotlin">Conversation</code>, you can use it to send message.</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">val message = &quot;Hello, how can I help you?&quot;<br>conversation.sendMessage(message)</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><p class="paragraph">The AXP Messaging module supports various types of messages, including:</p><ul><li><p class="paragraph">Text(Plain text, Emoji's, Links)</p></li><li><p class="paragraph">Postback</p></li><li><p class="paragraph">Reply</p></li><li><p class="paragraph">Attachment</p></li><li><p class="paragraph">Location</p></li></ul><h2 class="">Sending a Location Message</h2><p class="paragraph">A location message includes latitude and longitude coordinates. Here's an example of how you might send a location message:</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">// LOCATION_NAME, ADDRESS_LINE, PARENT_MESSAGE_ID are optional<br>conversation.sendMessage(LocationMessage(latitude, longitude, LOCATION_NAME, ADDRESS_LINE), PARENT_MESSAGE_ID)</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h2 class="">Sending a Postback Message</h2><p class="paragraph">Here's an example of how you might send a postback message:</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">// PARENT_MESSAGE_ID is optional<br>conversation.sendMessage(PostbackMessage(text, payload), PARENT_MESSAGE_ID)</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h2 class="">Sending a Reply Message</h2><p class="paragraph">Here's an example of how you might send a reply message:</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">// ICON_URL, PARENT_MESSAGE_ID are optional<br>conversation.sendMessage(ReplyMessage(text, payload, ICON_URL), PARENT_MESSAGE_ID)</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h2 class="">Sending an Attachment Message</h2><p class="paragraph">An attachment message includes a file and other data. Here's an example of how you might send an attachment message:</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">// CAPTION, PARENT_MESSAGE_ID are optional<br>conversation.sendMessage(AttachmentMessage(file, CAPTION), PARENT_MESSAGE_ID)</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><p class="paragraph">for all the above methods, we are even supporting the callback to get the status of the message sent.</p><h2 class="">Fetching Older Messages</h2><p class="paragraph">The AXP Messaging module allows you to fetch older messages from a conversation. This is done using the <code class="lang-kotlin">getMessages</code> method, which returns a <code class="lang-kotlin">PageIterator&lt;Message&gt;</code>. This iterator can be used to cycle through the messages.</p><p class="paragraph">Here's an example of how to fetch older messages:</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">// The default page size is 10<br>val messageIterator = conversation.getMessages(pageSize = 10)<br>if (messageIterator.hasNext()) {<br>    val nextMessagePage = messageIterator.next()<br>    // You can now use the messages from nextMessagePage<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h2 class="">Receive Latest Messages</h2><p class="paragraph">You can receive latest messages by adding a listener to the conversation or listening to the flow</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">// Using a listener<br>conversation.addMessageArrivedListener { message -&gt;<br>    // You can now use the received message<br>}<br><br>// Using flow<br>conversation.messageArrivedFlow.collect { message -&gt;<br>    // You can now use the received message<br>}<br><br>To check whether message has been delivered to the server. You can listen by adding a listener to<br>the conversation or listening to the flow<br><br>```kotlin<br>// Using a listener<br>conversation.addMessageDeliveredListener { message -&gt;<br>    // You can now use the delivered message<br>}<br><br>// Using flow<br>conversation.messageDeliveredFlow.collect { message -&gt;<br>    // You can now use the delivered message<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h2 class="">Monitoring Participant Changes</h2><p class="paragraph">You can monitor changes to the participants in a conversation by adding a listener to the conversation or by listening to the flow. Here's how:</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">// Using a listener<br>conversation.addParticipantsChangedListener { participantChange -&gt;<br>    // You can now use the participantChange object<br>}<br><br>// Using flow<br>conversation.participantsFlow.collect { participants -&gt;<br>    // You can now use the participants object<br>    val newParticipants: Set&lt;Participant&gt; = participants<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><p class="paragraph">To access participants that are only related to messaging, you can get them by</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">val messagingParticipants = conversation.participants(AxpChannel.MESSAGING)</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div></div></div>
  </div>
  <h2 class="">Packages</h2>
  <div class="table"><a data-name="-511733589%2FPackages%2F966333465" anchor-label="com.avaya.axp.client.sdk.messaging" id="-511733589%2FPackages%2F966333465" data-filterable-set=":messaging:dokkaHtml/main"></a>
    <div class="table-row" data-filterable-current=":messaging:dokkaHtml/main" data-filterable-set=":messaging:dokkaHtml/main">
      <div>
        <div class="main-subrow ">
          <div class=""><span class="inline-flex">
              <div><a href="-a-x-p -messaging/com.avaya.axp.client.sdk.messaging/index.html">com.avaya.axp.client.sdk.messaging</a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-511733589%2FPackages%2F966333465"></span>
                <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
              </span></span></div>
          <div class="pull-right">
            <div class="platform-tags no-gutters">
              <div class="platform-tag jvm-like">jvm</div>
            </div>
          </div>
        </div>
        <div></div>
      </div>
    </div>
  </div>
</div>
      <div class="footer">
        <span class="go-to-top-icon"><a href="#content" id="go-to-top-link"></a></span><span>© 2024 Copyright</span><span
                class="pull-right"><span>Generated by </span><a
                href="https://github.com/Kotlin/dokka"><span>dokka</span><span class="padded-icon"></span></a></span>
      </div>
            </div>
        </div>
    </div>
</body>
</html>
